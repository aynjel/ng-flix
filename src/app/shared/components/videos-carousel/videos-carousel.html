<!-- Videos Carousel -->
@if (videos.length > 0) {
<div class="w-full">
  <div class="flex items-center justify-between mb-6">
    <h2 class="text-3xl font-bold">Trailers & Videos</h2>

    <!-- Navigation Controls -->
    <div class="flex gap-2">
      <button
        class="btn btn-circle btn-sm btn-outline"
        [class.btn-disabled]="!canGoPrevious()"
        (click)="previous()"
        [disabled]="!canGoPrevious()"
        aria-label="Previous videos"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-4 w-4"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 19l-7-7 7-7"
          />
        </svg>
      </button>

      <button
        class="btn btn-circle btn-sm btn-outline"
        [class.btn-disabled]="!canGoNext()"
        (click)="next()"
        [disabled]="!canGoNext()"
        aria-label="Next videos"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-4 w-4"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"
          />
        </svg>
      </button>
    </div>
  </div>

  <!-- Carousel Container -->
  <div class="relative overflow-hidden">
    <div
      class="flex transition-transform duration-500 ease-in-out"
      [style.transform]="'translateX(-' + (currentIndex() * (100 / itemsPerView())) + '%)'"
    >
      @for (video of videos; track video.id) {
      <div
        class="flex-shrink-0 w-full sm:w-full md:w-full lg:w-1/2 xl:w-1/2 2xl:w-1/3 px-3"
      >
        <div
          class="card bg-base-100 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] h-full"
        >
          <figure class="aspect-video overflow-hidden relative group">
            <img
              [src]="getYouTubeThumbnailUrl(video.key)"
              [alt]="video.name"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
            />

            <!-- Play Button Overlay -->
            <div
              class="absolute inset-0 flex items-center justify-center bg-black/40 hover:bg-black/30 transition-all duration-300"
            >
              <button
                class="btn btn-circle btn-primary btn-lg shadow-2xl transform transition-all duration-300 hover:scale-110 hover:shadow-primary/50"
                (click)="openVideoModal(video)"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-8 w-8 ml-1"
                  fill="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path d="M8 5v14l11-7z" />
                </svg>
              </button>
            </div>

            <!-- Video Duration Badge -->
            <div class="absolute top-3 right-3">
              <div class="badge badge-primary badge-sm shadow-lg">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-3 w-3 mr-1"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                  />
                </svg>
                Video
              </div>
            </div>
          </figure>

          <div class="card-body p-4">
            <h3 class="card-title text-lg font-semibold line-clamp-2 mb-2">
              {{ video.name }}
            </h3>

            <div class="flex items-center gap-2 flex-wrap">
              <span class="badge badge-outline badge-sm">{{ video.type }}</span>
              @if (video.official) {
              <span class="badge badge-primary badge-sm">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-3 w-3 mr-1"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                  />
                </svg>
                Official
              </span>
              }
              <span class="badge badge-ghost badge-sm">{{ video.site }}</span>
            </div>

            <!-- Video Info -->
            <div class="mt-3 text-sm text-base-content/70">
              <div class="flex items-center gap-2">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-4 w-4"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                  />
                </svg>
                <span>{{ video.published_at | date:'MMM d, y' }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      }
    </div>
  </div>

  <!-- Carousel Indicators -->
  @if (maxIndex() > 0) {
  <div class="flex justify-center mt-6 gap-2">
    @for (dot of getIndicatorArray(); track $index) {
    <button
      class="w-3 h-3 rounded-full transition-all duration-200"
      [class.bg-primary]="$index === currentIndex()"
      [class.bg-base-300]="$index !== currentIndex()"
      [class.scale-110]="$index === currentIndex()"
      (click)="currentIndex.set($index)"
      [attr.aria-label]="'Go to slide ' + ($index + 1)"
    ></button>
    }
  </div>
  }
</div>
}

<!-- Video Modal -->
@if (selectedVideo()) {
<div class="modal modal-open">
  <div class="modal-box max-w-5xl">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-xl font-bold">{{ selectedVideo()!.name }}</h3>
      <button
        class="btn btn-sm btn-circle btn-ghost"
        (click)="closeVideoModal()"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>
    </div>

    <div class="aspect-video">
      <iframe
        [src]="getYouTubeEmbedUrl(selectedVideo()!.key)"
        [title]="selectedVideo()!.name"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen
        class="w-full h-full rounded-lg shadow-lg"
      ></iframe>
    </div>

    <!-- Video Details in Modal -->
    <div class="mt-4 p-4 bg-base-200 rounded-lg">
      <div class="flex items-center gap-2 flex-wrap">
        <span class="badge badge-outline">{{ selectedVideo()!.type }}</span>
        @if (selectedVideo()!.official) {
        <span class="badge badge-primary">Official</span>
        }
        <span class="badge badge-ghost">{{ selectedVideo()!.site }}</span>
      </div>
      <p class="text-sm text-base-content/70 mt-2">
        Published: {{ selectedVideo()!.published_at | date:'fullDate' }}
      </p>
    </div>
  </div>
  <div class="modal-backdrop" (click)="closeVideoModal()"></div>
</div>
}
